/*
 * FOstatus by Rotators
 * https://github.com/rotators/fodev-status/
 *
 * @preserve
 */
function FOstatus(){this.Config=null}FOstatus.prototype.defaultArgument=function(n,o){return"undefined"!=typeof n?n:o},FOstatus.prototype.ExtractSeconds=function(n){var o=function(o){var e=0;return n>=o&&(e=Math.floor(n/o),n-=e*o),e},e=o(29030400),t=o(2419200),i=o(604800),l=o(86400),r=o(3600),u=o(60);return[e,t,i,l,r,u,n]},FOstatus.prototype.LoadJSON=function(n,o,e){var t="[LoadJSON] Can't load "+(null!=o?o+" @ ":"")+n+" : ";if(null==n)return console.log("[LoadJSON] URL not defined"),null;if(null==o)return console.log(t+"data type not defined"),null;if(null==e)return console.log(t+"callback not defined"),null;if(null==this.JSONLoader)return console.log(t+"JSONLoader not defined"),null;var i=this.JSONLoader(n,function(n){null==n.fonline?console.log(t+"Missing data->fonline"):null==n.fonline[o]?console.log(t+"Missing data->fonline->"+o):e(n.fonline[o])});return i},FOstatus.prototype.LoadConfig=function(n,o){var e="[LoadConfig] ";if(null==n){if(null==this.ConfigURL)return console.log(e+"URL not defined"),null;n=this.ConfigURL}var t=this;this.Config=null;var i=this.LoadJSON(n,"config",function(n){t.Config=n,null!=o&&o()});return i},FOstatus.prototype.CheckConfig=function(n,o){if(null==n)return console.log("CheckConfig: data is null"),!1;o=this.defaultArgument(o,!1);var e=null;if(o)console.log("CheckConfig: skipping base structure check"),e=n;else{if(null==n.fonline)return console.log("CheckConfig: missing fonline"),!1;if(null==n.fonline.config)return console.log("CheckConfig: missing fonline::config"),!1;e=n.fonline.config}if(null==e.server)return console.log("CheckConfig: missing fonline::config::server"),!1;for(id in e.server){var t=e.server[id];if(null==t.name)return console.log("CheckConfig: missing fonline::config::server::"+idx+"::name"),!1;if(null!=t.host&&null==t.port)return console.log("CheckConfig: fonline::config::server::"+id+" : host set, port is null"),!1;if(null==t.host&&null!=t.port)return console.log("CheckConfig: fonline::config::server::"+id+" : host is null, port is set"),!1;if(null!=t.irc&&"#"!=t.irc.charAt(0))return console.log("CheckConfig: fonline::config::server::"+id+" : irc channel does not start with '#'"),!1;if(null!=t.color){if("#"!=t.color.charAt(0))return console.log("CheckConfig: fonline::config::server::"+id+" : color does not start with '#'"),!1;if(7!=t.color.length)return console.log("CheckConfig: fonline::config::server::"+id+" : invalid color length"),!1}}return console.log("CheckConfig: OK"),!0},FOstatus.prototype.GetServer=function(n){if(null==n)return null;if(null!=this.Config&&null!=this.Config.server&&null!=this.Config.server[n]){var o=this.Config.server[n];return o.id=n,o}return null},FOstatus.prototype.GetServerBy=function(n,o){if(null==n||null==o)return null;if(null!=this.Config&&null!=this.Config.server)for(id in this.Config.server){var e=this.Config.server[id];if(null!=e[n]&&e[n]==o)return e.id=id,e}return null},FOstatus.prototype.GetOption=function(n,o){return null==n||null==o?null:null==this.Config||null==this.Config[n]?null:null!=this.Config[n][o]?this.Config[n][o]:null},FOstatus.prototype.GetServerOption=function(n,o){if(null==n||null==o)return null;var e=this.GetServer(n);return null!=e&&null!=e[o]?e[o]:null},FOstatus.prototype.GetServersArray=function(n,o){n=this.defaultArgument(n,null),o=this.defaultArgument(o,!0);var e=[];if(null!=this.Config&&null!=this.Config.server)for(id in this.Config.server){var t=this.Config.server[id];t.id=id,e.push(t)}return null!=n&&(e=e.sort(function(e,t){return e[n]==t[n]?0:o?e[n].toLowerCase()>t[n].toLowerCase()?1:-1:t[n].toLowerCase()>e[n].toLowerCase()?1:-1})),e},FOstatus.prototype.GetPath=function(n,o){if(null==n)return null;var e=null;if(null!=this.Config&&null!=this.Config.files&&null!=this.Config.files[n]){if(e=this.Config.files[n],null!=this.Config.dirs)for(id in this.Config.dirs)e=e.replace("{DIR:"+id+"}",this.Config.dirs[id]);if(null!=o)for(id in o)e=e.replace("{"+id+"}",o[id])}return e},"undefined"!=typeof window.jQuery?(FOstatus.prototype.JSONLoader=function(n,o){var e=$.ajax({dataType:"json",url:n,async:!0,success:function(n){null!=o&&o(n)},error:function(o,e,t){console.log("[JSONLoader:jQuery] ERROR : "+n+" : "+e+" : "+t)}});return e},FOstatus.prototype.LoadJSONQueue=function(n,o,e,t){var i=this,l=function(){var n=[],l={};$.each(e,function(e,t){var r={},u=t.split(":",2);if(u.length>1){var s=u[1].split(",");$.each(s,function(n,o){var e=o.split("=");2==e.length&&(r[e[0]]=e[1])})}var f=i.GetPath(u[0],r);return null==f?(l[t]=null,!0):void n.push(i.LoadJSON(o+f,u[0],function(n){l[t]=n}))}),$.when.apply($,n).done(function(){t(l)})};if(null==this.Config||n){if(null==this.ConfigURL)return;this.LoadConfig(null,l)}else l()}):"undefined"!=typeof window.Prototype&&(FOstatus.prototype.JSONLoader=function(n,o){new Ajax.Request(n,{method:"get",asynchronous:!0,onCreate:function(n){var o=n.transport;o.setRequestHeader=o.setRequestHeader.wrap(function(n,o,e){return/^(accept|accept-language|content-language)$/i.test(o)?n(o,e):void 0})},onComplete:function(n){null!=o&&null!=n.responseJSON&&o(n.responseJSON)},onFailure:function(o){console.log("[JSONLoader:prototype] ERROR : "+n+" : "+o.statusText)}})});