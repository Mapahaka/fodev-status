<!DOCTYPE html>
<html>
<head>
	<title>fodev-status demonstration</title>
	<script src="//code.jquery.com/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="//fodev.net/status/js/fostatus.js" type="text/javascript"></script>
	<script src="//www.google.com/jsapi" type="text/javascript"></script>
</head>
<body>

<div id="players" style="width: 100%; height: 555px;"></div>

<script type="text/javascript">
google.load( "visualization", "1", { packages:[ "corechart" ]});
google.setOnLoadCallback( drawChart );

function drawChart()
{
	var fodev = 'http://fodev.net/status/data/';

	var fo = new FOstatus();
	if( !fo.LoadConfig( fodev+'config.json' ))
		return;

	if( !fo.CheckConfig( fo.Config, true ))
	{
		console.Log( "Invalid config" );
		return;
	}

	var chart_data = [['Server', 'Players' ]];
	var chart_slices = [];

	fo.LoadJSON( fodev+fo.GetPath( 'status' ), 'status', function( data )
	{
		$.each( fo.GetServersArray( 'name' ), function( i, server )
		{
			if( data.server[server.id] != null && data.server[server.id].players >= 0 )
			{
				chart_data.push([ server.name, data.server[server.id].players ]);
				if( server.color != null )
					chart_slices.push({ color: server.color });
				else
					chart_slices.push({ color: '#ffffff' });
			}
		});
	});

	var chart = new google.visualization.PieChart(document.getElementById('players'));
	chart.draw(
		google.visualization.arrayToDataTable( chart_data ),
		{
			title: 'FOnline players distribution',
			is3D: true,
			slices: chart_slices,
		}
	);
}
</script>
</body>
</html>
